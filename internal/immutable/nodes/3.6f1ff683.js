import{e as K}from"../chunks/index.93323930.js";import{a as Q}from"../chunks/albums.controller.5f54c591.js";import{s as q,f as p,a as S,g as b,h as w,d as f,c as M,j as d,i as v,v as m,A as g,o as W,L as X,l as U,m as B,O as C,n as A,J as Y,D as Z}from"../chunks/scheduler.fb79c3ec.js";import{h as y,u as I,e as N,P as x}from"../chunks/Placeholder.4405300c.js";import{S as G,i as V,a as T,t as E,b as z,d as J,m as R,e as F}from"../chunks/index.bb4217d0.js";import{b as ee}from"../chunks/paths.cad6c579.js";import{d as O}from"../chunks/downloader.controller.3605e98c.js";function te(o,t){let a=o.searchParams.get(t);if(a)return a;throw K(500,`The value for the parameter "${t}" was not provided.`)}const le=async({url:o,parent:t})=>{const a=te(o,"albumUrl"),{environmentStore:e}=await t();return{environmentStore:e,albumUrl:a,streamed:{album:Q.getAlbum(a)}}},ge=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"}));function ne(o){let t,a,e,n,s;return{c(){t=p("span"),a=S(),e=p("span"),n=S(),s=p("span"),this.h()},l(l){t=b(l,"SPAN",{class:!0}),w(t).forEach(f),a=M(l),e=b(l,"SPAN",{class:!0}),w(e).forEach(f),n=M(l),s=b(l,"SPAN",{class:!0}),w(s).forEach(f),this.h()},h(){d(t,"class","artwork w-52 h-60 bg-stone-200 animate-pulse"),d(e,"class","h-5 w-20 rounded-md self-center bg-stone-200 animate-pulse my-3"),d(s,"class","h-3 w-32 rounded-md self-center bg-stone-200 animate-pulse")},m(l,r){v(l,t,r),v(l,a,r),v(l,e,r),v(l,n,r),v(l,s,r)},p:m,i:m,o:m,d(l){l&&(f(t),f(a),f(e),f(n),f(s))}}}class ae extends G{constructor(t){super(),V(this,t,null,ne,q,{})}}function j(o,t,a){const e=o.slice();return e[6]=t[a],e}function oe(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function re(o){let t,a,e,n,s,l=o[5].albumTitle+"",r,c,u,k=o[5].artistName+"",P;return{c(){t=p("img"),e=S(),n=p("div"),s=p("h3"),r=U(l),c=S(),u=p("p"),P=U(k),this.h()},l(i){t=b(i,"IMG",{class:!0,src:!0,alt:!0}),e=M(i),n=b(i,"DIV",{class:!0});var h=w(n);s=b(h,"H3",{class:!0});var _=w(s);r=B(_,l),_.forEach(f),c=M(h),u=b(h,"P",{});var $=w(u);P=B($,k),$.forEach(f),h.forEach(f),this.h()},h(){d(t,"class","artwork"),C(t.src,a=o[5].albumImage)||d(t,"src",a),d(t,"alt","cover"),d(s,"class","title"),d(n,"class","headings")},m(i,h){v(i,t,h),v(i,e,h),v(i,n,h),g(n,s),g(s,r),g(n,c),g(n,u),g(u,P)},p(i,h){h&1&&!C(t.src,a=i[5].albumImage)&&d(t,"src",a),h&1&&l!==(l=i[5].albumTitle+"")&&A(r,l),h&1&&k!==(k=i[5].artistName+"")&&A(P,k)},i:m,o:m,d(i){i&&(f(t),f(e),f(n))}}}function se(o){let t,a;return t=new ae({}),{c(){z(t.$$.fragment)},l(e){J(t.$$.fragment,e)},m(e,n){R(t,e,n),a=!0},p:m,i(e){a||(T(t.$$.fragment,e),a=!0)},o(e){E(t.$$.fragment,e),a=!1},d(e){F(t,e)}}}function ce(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function ie(o){let t,a=N(o[5].result),e=[];for(let n=0;n<a.length;n+=1)e[n]=L(j(o,a,n));return{c(){t=p("ul");for(let n=0;n<e.length;n+=1)e[n].c();this.h()},l(n){t=b(n,"UL",{class:!0});var s=w(t);for(let l=0;l<e.length;l+=1)e[l].l(s);s.forEach(f),this.h()},h(){d(t,"class","track-list")},m(n,s){v(n,t,s);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(t,null)},p(n,s){if(s&7){a=N(n[5].result);let l;for(l=0;l<a.length;l+=1){const r=j(n,a,l);e[l]?e[l].p(r,s):(e[l]=L(r),e[l].c(),e[l].m(t,null))}for(;l<e.length;l+=1)e[l].d(1);e.length=a.length}},i:m,o:m,d(n){n&&f(t),Y(e,n)}}}function H(o){let t,a;return{c(){t=p("img"),this.h()},l(e){t=b(e,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){C(t.src,a=ee+"/check-circle.svg")||d(t,"src",a),d(t,"alt","check"),d(t,"class","h-5 w-5")},m(e,n){v(e,t,n)},p:m,d(e){e&&f(t)}}}function L(o){let t,a,e,n=o[6].title+"",s,l,r=o[1].includes(o[6].youTubeMusicPlaylistUrl),c,u,k;function P(){return o[3](o[6])}let i=r&&H();return{c(){t=p("li"),a=p("button"),e=p("p"),s=U(n),l=S(),i&&i.c(),c=S(),this.h()},l(h){t=b(h,"LI",{});var _=w(t);a=b(_,"BUTTON",{class:!0});var $=w(a);e=b($,"P",{});var D=w(e);s=B(D,n),D.forEach(f),$.forEach(f),l=M(_),i&&i.l(_),c=M(_),_.forEach(f),this.h()},h(){d(a,"class","track")},m(h,_){v(h,t,_),g(t,a),g(a,e),g(e,s),g(t,l),i&&i.m(t,null),g(t,c),u||(k=Z(a,"click",P),u=!0)},p(h,_){o=h,_&1&&n!==(n=o[6].title+"")&&A(s,n),_&3&&(r=o[1].includes(o[6].youTubeMusicPlaylistUrl)),r?i?i.p(o,_):(i=H(),i.c(),i.m(t,c)):i&&(i.d(1),i=null)},d(h){h&&f(t),i&&i.d(),u=!1,k()}}}function ue(o){let t,a;return t=new x({props:{count:8,_class:"album-entry track-list mt-0"}}),{c(){z(t.$$.fragment)},l(e){J(t.$$.fragment,e)},m(e,n){R(t,e,n),a=!0},p:m,i(e){a||(T(t.$$.fragment,e),a=!0)},o(e){E(t.$$.fragment,e),a=!1},d(e){F(t,e)}}}function me(o){let t,a,e,n,s,l={ctx:o,current:null,token:null,hasCatch:!1,pending:se,then:re,catch:oe,value:5,blocks:[,,,]};y(a=o[0].streamed.album,l);let r={ctx:o,current:null,token:null,hasCatch:!1,pending:ue,then:ie,catch:ce,value:5,blocks:[,,,]};return y(n=o[0].streamed.album,r),{c(){t=p("div"),l.block.c(),e=S(),r.block.c(),this.h()},l(c){t=b(c,"DIV",{class:!0});var u=w(t);l.block.l(u),e=M(u),r.block.l(u),u.forEach(f),this.h()},h(){d(t,"class","album-entry")},m(c,u){v(c,t,u),l.block.m(t,l.anchor=null),l.mount=()=>t,l.anchor=e,g(t,e),r.block.m(t,r.anchor=null),r.mount=()=>t,r.anchor=null,s=!0},p(c,[u]){o=c,l.ctx=o,u&1&&a!==(a=o[0].streamed.album)&&y(a,l)||I(l,o,u),r.ctx=o,u&1&&n!==(n=o[0].streamed.album)&&y(n,r)||I(r,o,u)},i(c){s||(T(l.block),T(r.block),s=!0)},o(c){for(let u=0;u<3;u+=1){const k=l.blocks[u];E(k)}for(let u=0;u<3;u+=1){const k=r.blocks[u];E(k)}s=!1},d(c){c&&f(t),l.block.d(),l.token=null,l=null,r.block.d(),r.token=null,r=null}}}function fe(o,t,a){let{data:e}=t,n=[];function s(c){n.includes(c)?(n.splice(n.indexOf(c),1),a(1,n)):a(1,n=[...n,c]),e.environmentStore.envokeHaptic("light")}async function l(c){n.length>0?await O.downloadSet(n):c&&await O.download(c,1),e.environmentStore.envokeHaptic("heavy"),e.environmentStore.close()}W(async()=>{e.environmentStore.showMainButton("Download Album"),e.environmentStore.onMainButtonClick(()=>l(e.albumUrl))}),X(()=>{e.environmentStore.offMainButtonClick(()=>l(e.albumUrl)),e.environmentStore.hideMainButton()});const r=c=>s(c.youTubeMusicPlaylistUrl);return o.$$set=c=>{"data"in c&&a(0,e=c.data)},o.$$.update=()=>{o.$$.dirty&3&&(n.length>0?(e.environmentStore.setMainButtonText(`Download Tracks (${n.length})`),e.environmentStore.onMainButtonClick(()=>l())):(e.environmentStore.setMainButtonText("Download Album"),e.environmentStore.onMainButtonClick(()=>l(e.albumUrl))))},[e,n,s,r]}class we extends G{constructor(t){super(),V(this,t,fe,me,q,{data:0})}}export{we as component,ge as universal};
