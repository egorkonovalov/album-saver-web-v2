import{e as E}from"../chunks/index.CzR0xuCU.js";import{a as G}from"../chunks/albums.controller.BlcZQjo6.js";import{a as m,t as d}from"../chunks/disclose-version.CxhRANXo.js";import{a2 as H,p as W,a3 as A,g as F,a as J,G as _,k as a,c as u,s as h,r as i,f as K,t as D}from"../chunks/runtime.DJK5OjHR.js";import{d as Q,s as B}from"../chunks/render.DJPECFcd.js";import{a as O,s as S,e as V,i as X}from"../chunks/attributes.Cg3wPQw7.js";import{o as Y,a as Z,i as L}from"../chunks/index-client.Ch5NUNdE.js";import{p as N}from"../chunks/props.nCNZolO7.js";import{s as $,a as aa}from"../chunks/store.njbblRzr.js";import{P as ta}from"../chunks/Placeholder.BmwCSx2O.js";import{b as ea}from"../chunks/paths.Wm1Rnjzg.js";import"../chunks/legacy.CUdD9rQp.js";import{d as j}from"../chunks/downloader.controller.BFOUfmJS.js";import{t as r}from"../chunks/telegram.service.BtJAcorA.js";import{p as ra}from"../chunks/stores.BdaVKGEL.js";function oa(l,t){let o=l.searchParams.get(t);if(o)return o;E(500,`The value for the parameter "${t}" was not provided.`)}const sa=async({url:l})=>{const t=oa(l,"albumUrl");return{albumUrl:t,streamed:{album:G.getAlbum(t)}}},Ia=Object.freeze(Object.defineProperty({__proto__:null,load:sa},Symbol.toStringTag,{value:"Module"}));var la=d('<span class="artwork bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse aspect-square"></span> <span class="h-5 w-20 rounded-md self-center bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse my-3"></span> <span class="h-3 w-32 rounded-md self-center bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse"></span>',1);function ia(l){var t=la();H(4),m(l,t)}var na=(l,t,o,y)=>t({title:a(o).albumTitle,author:a(o).artistName,imageUrl:a(o).albumImage,year:"",recordType:"Album",youTubeMusicPlaylistUrl:y().url.searchParams.get("albumUrl")||""}),ca=d('<button>Add <span class="rounded-full bg-blue-500 text-white px-2 py-1">+</span></button>'),ua=d('<img class="artwork" alt="cover"> <div class="headings"><h3 class="title"> </h3> <p> </p></div> <!>',1),ma=(l,t,o)=>t(a(o).youTubeMusicPlaylistUrl),da=d('<img alt="check" class="h-5 w-5">'),ba=d('<li><button class="track"><p> </p></button> <!></li>'),pa=d('<ul class="track-list"></ul>'),fa=d('<div class="album-entry"><!> <!></div>');function Da(l,t){W(t,!0);const o=$(),y=()=>aa(ra,"$page",o);let s=A(N([])),C=A(!1);function R(e){a(s).includes(e)?a(s).splice(a(s).indexOf(e),1):_(s,N(a(s).concat(e))),r.envokeHaptic("light")}async function w(e){a(s).length>0?await j.downloadSet(a(s)):e&&await j.download(e,1),r.closeWith("success")}F(()=>{a(s).length>0?(r.setMainButtonText(`Download Tracks (${a(s).length})`),r.onMainButtonClick(w)):(r.setMainButtonText("Download Album"),r.onMainButtonClick(()=>w(t.data.albumUrl)))});async function q(e){if(e.youTubeMusicPlaylistUrl.length===0)throw Error("No album URL");_(C,!0),await r.addToArrayItem("library",e),_(C,!1),_(M,!0)}let M=A(!1);Y(async()=>{r.showMainButton("Download Album"),r.onMainButtonClick(()=>w(t.data.albumUrl)),await r.findInArrayItem("library",y().url.searchParams.get("albumUrl")||"","youTubeMusicPlaylistUrl")&&_(M,!0)}),Z(()=>{r.offMainButtonClick(()=>w(t.data.albumUrl)),r.hideMainButton()});var T=fa(),I=u(T);O(I,()=>t.data.streamed.album,e=>{ia(e,{})},(e,b)=>{var p=ua(),k=K(p),n=h(k,2),c=u(n),f=u(c,!0);i(c);var g=h(c,2),U=u(g,!0);i(g),i(n);var x=h(n,2);L(x,()=>!a(M),P=>{var v=ca();v.__click=[na,q,b,y],m(P,v)}),D(()=>{S(k,"src",a(b).albumImage),B(f,a(b).albumTitle),B(U,a(b).artistName)}),m(e,p)});var z=h(I,2);O(z,()=>t.data.streamed.album,e=>{ta(e,{count:8,_class:"album-entry track-list mt-0"})},(e,b)=>{var p=pa();V(p,21,()=>a(b).result,X,(k,n)=>{var c=ba(),f=u(c);f.__click=[ma,R,n];var g=u(f),U=u(g,!0);i(g),i(f);var x=h(f,2);L(x,()=>a(s).includes(a(n).youTubeMusicPlaylistUrl),P=>{var v=da();S(v,"src",`${ea??""}/check-circle.svg`),m(P,v)}),i(c),D(()=>B(U,a(n).title)),m(k,c)}),i(p),m(e,p)}),i(T),m(l,T),J()}Q(["click"]);export{Da as component,Ia as universal};
