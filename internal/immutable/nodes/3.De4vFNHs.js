import{e as K}from"../chunks/index.CzR0xuCU.js";import{a as Q}from"../chunks/albums.controller.CvCgrZUq.js";import{s as G,e as p,a as S,c as b,b as w,f,g as y,m as d,i as g,n as m,h as v,u as W,A as X,t as B,d as U,B as C,j as A,o as Y,p as Z}from"../chunks/scheduler.Br1097ij.js";import{h as $,u as D,e as N,P as x}from"../chunks/Placeholder.CEXoF0fh.js";import{S as L,i as V,t as T,a as E,b as z,d as R,m as F,e as J}from"../chunks/index.DJz_kk84.js";import{b as ee}from"../chunks/paths.DS_ok6AH.js";import{d as O}from"../chunks/downloader.controller.C9LOnaBQ.js";function te(r,t){let n=r.searchParams.get(t);if(n)return n;K(500,`The value for the parameter "${t}" was not provided.`)}const le=async({url:r,parent:t})=>{const n=te(r,"albumUrl"),{environmentStore:e}=await t();return{environmentStore:e,albumUrl:n,streamed:{album:Q.getAlbum(n)}}},ve=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"}));function ae(r){let t,n,e,a,s;return{c(){t=p("span"),n=S(),e=p("span"),a=S(),s=p("span"),this.h()},l(l){t=b(l,"SPAN",{class:!0}),w(t).forEach(f),n=y(l),e=b(l,"SPAN",{class:!0}),w(e).forEach(f),a=y(l),s=b(l,"SPAN",{class:!0}),w(s).forEach(f),this.h()},h(){d(t,"class","artwork bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse aspect-square"),d(e,"class","h-5 w-20 rounded-md self-center bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse my-3"),d(s,"class","h-3 w-32 rounded-md self-center bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse")},m(l,o){g(l,t,o),g(l,n,o),g(l,e,o),g(l,a,o),g(l,s,o)},p:m,i:m,o:m,d(l){l&&(f(t),f(n),f(e),f(a),f(s))}}}class ne extends L{constructor(t){super(),V(this,t,null,ae,G,{})}}function j(r,t,n){const e=r.slice();return e[6]=t[n],e}function re(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function oe(r){let t,n,e,a,s,l=r[5].albumTitle+"",o,c,u,k=r[5].artistName+"",M;return{c(){t=p("img"),e=S(),a=p("div"),s=p("h3"),o=B(l),c=S(),u=p("p"),M=B(k),this.h()},l(i){t=b(i,"IMG",{class:!0,src:!0,alt:!0}),e=y(i),a=b(i,"DIV",{class:!0});var h=w(a);s=b(h,"H3",{class:!0});var _=w(s);o=U(_,l),_.forEach(f),c=y(h),u=b(h,"P",{});var P=w(u);M=U(P,k),P.forEach(f),h.forEach(f),this.h()},h(){d(t,"class","artwork"),C(t.src,n=r[5].albumImage)||d(t,"src",n),d(t,"alt","cover"),d(s,"class","title"),d(a,"class","headings")},m(i,h){g(i,t,h),g(i,e,h),g(i,a,h),v(a,s),v(s,o),v(a,c),v(a,u),v(u,M)},p(i,h){h&1&&!C(t.src,n=i[5].albumImage)&&d(t,"src",n),h&1&&l!==(l=i[5].albumTitle+"")&&A(o,l),h&1&&k!==(k=i[5].artistName+"")&&A(M,k)},i:m,o:m,d(i){i&&(f(t),f(e),f(a))}}}function se(r){let t,n;return t=new ne({}),{c(){z(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,a){F(t,e,a),n=!0},p:m,i(e){n||(T(t.$$.fragment,e),n=!0)},o(e){E(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function ce(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function ie(r){let t,n=N(r[5].result),e=[];for(let a=0;a<n.length;a+=1)e[a]=H(j(r,n,a));return{c(){t=p("ul");for(let a=0;a<e.length;a+=1)e[a].c();this.h()},l(a){t=b(a,"UL",{class:!0});var s=w(t);for(let l=0;l<e.length;l+=1)e[l].l(s);s.forEach(f),this.h()},h(){d(t,"class","track-list")},m(a,s){g(a,t,s);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(t,null)},p(a,s){if(s&7){n=N(a[5].result);let l;for(l=0;l<n.length;l+=1){const o=j(a,n,l);e[l]?e[l].p(o,s):(e[l]=H(o),e[l].c(),e[l].m(t,null))}for(;l<e.length;l+=1)e[l].d(1);e.length=n.length}},i:m,o:m,d(a){a&&f(t),Y(e,a)}}}function q(r){let t,n;return{c(){t=p("img"),this.h()},l(e){t=b(e,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){C(t.src,n=ee+"/check-circle.svg")||d(t,"src",n),d(t,"alt","check"),d(t,"class","h-5 w-5")},m(e,a){g(e,t,a)},p:m,d(e){e&&f(t)}}}function H(r){let t,n,e,a=r[6].title+"",s,l,o=r[1].includes(r[6].youTubeMusicPlaylistUrl),c,u,k;function M(){return r[3](r[6])}let i=o&&q();return{c(){t=p("li"),n=p("button"),e=p("p"),s=B(a),l=S(),i&&i.c(),c=S(),this.h()},l(h){t=b(h,"LI",{});var _=w(t);n=b(_,"BUTTON",{class:!0});var P=w(n);e=b(P,"P",{});var I=w(e);s=U(I,a),I.forEach(f),P.forEach(f),l=y(_),i&&i.l(_),c=y(_),_.forEach(f),this.h()},h(){d(n,"class","track")},m(h,_){g(h,t,_),v(t,n),v(n,e),v(e,s),v(t,l),i&&i.m(t,null),v(t,c),u||(k=Z(n,"click",M),u=!0)},p(h,_){r=h,_&1&&a!==(a=r[6].title+"")&&A(s,a),_&3&&(o=r[1].includes(r[6].youTubeMusicPlaylistUrl)),o?i?i.p(r,_):(i=q(),i.c(),i.m(t,c)):i&&(i.d(1),i=null)},d(h){h&&f(t),i&&i.d(),u=!1,k()}}}function ue(r){let t,n;return t=new x({props:{count:8,_class:"album-entry track-list mt-0"}}),{c(){z(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,a){F(t,e,a),n=!0},p:m,i(e){n||(T(t.$$.fragment,e),n=!0)},o(e){E(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function me(r){let t,n,e,a,s,l={ctx:r,current:null,token:null,hasCatch:!1,pending:se,then:oe,catch:re,value:5,blocks:[,,,]};$(n=r[0].streamed.album,l);let o={ctx:r,current:null,token:null,hasCatch:!1,pending:ue,then:ie,catch:ce,value:5,blocks:[,,,]};return $(a=r[0].streamed.album,o),{c(){t=p("div"),l.block.c(),e=S(),o.block.c(),this.h()},l(c){t=b(c,"DIV",{class:!0});var u=w(t);l.block.l(u),e=y(u),o.block.l(u),u.forEach(f),this.h()},h(){d(t,"class","album-entry")},m(c,u){g(c,t,u),l.block.m(t,l.anchor=null),l.mount=()=>t,l.anchor=e,v(t,e),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,s=!0},p(c,[u]){r=c,l.ctx=r,u&1&&n!==(n=r[0].streamed.album)&&$(n,l)||D(l,r,u),o.ctx=r,u&1&&a!==(a=r[0].streamed.album)&&$(a,o)||D(o,r,u)},i(c){s||(T(l.block),T(o.block),s=!0)},o(c){for(let u=0;u<3;u+=1){const k=l.blocks[u];E(k)}for(let u=0;u<3;u+=1){const k=o.blocks[u];E(k)}s=!1},d(c){c&&f(t),l.block.d(),l.token=null,l=null,o.block.d(),o.token=null,o=null}}}function fe(r,t,n){let{data:e}=t,a=[];function s(c){a.includes(c)?(a.splice(a.indexOf(c),1),n(1,a)):n(1,a=[...a,c]),e.environmentStore.envokeHaptic("light")}async function l(c){a.length>0?await O.downloadSet(a):c&&await O.download(c,1),e.environmentStore.envokeHaptic("heavy"),e.environmentStore.close()}W(async()=>{e.environmentStore.showMainButton("Download Album"),e.environmentStore.onMainButtonClick(()=>l(e.albumUrl))}),X(()=>{e.environmentStore.offMainButtonClick(()=>l(e.albumUrl)),e.environmentStore.hideMainButton()});const o=c=>s(c.youTubeMusicPlaylistUrl);return r.$$set=c=>{"data"in c&&n(0,e=c.data)},r.$$.update=()=>{r.$$.dirty&3&&(a.length>0?(e.environmentStore.setMainButtonText(`Download Tracks (${a.length})`),e.environmentStore.onMainButtonClick(l)):(e.environmentStore.setMainButtonText("Download Album"),e.environmentStore.onMainButtonClick(()=>l(e.albumUrl))))},[e,a,s,o]}class we extends L{constructor(t){super(),V(this,t,fe,me,G,{data:0})}}export{we as component,ve as universal};
