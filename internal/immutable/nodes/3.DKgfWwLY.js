import{e as E}from"../chunks/index.CzR0xuCU.js";import{a as H}from"../chunks/albums.controller.1m07Dhsy.js";import{a as u,t as d}from"../chunks/disclose-version.p3TvJaWJ.js";import{ax as J,p as W,ay as A,g as F,a as G,J as _,k as a,c as m,s as h,r as i,f as K,t as D}from"../chunks/runtime.-sM8FUqq.js";import{d as Q,s as B}from"../chunks/render.Ckb9lNo4.js";import{a as O,e as V,i as X}from"../chunks/each.ByrFPfAp.js";import{o as Y,a as Z,i as S}from"../chunks/index-client.BlydL69K.js";import{s as L}from"../chunks/attributes.Bvm8Gd-x.js";import{p as N}from"../chunks/props.BwDQQAiG.js";import{s as $,a as aa}from"../chunks/store.CZVU3hEK.js";import{P as ta}from"../chunks/Placeholder.BP1OdUM3.js";import{b as ea}from"../chunks/paths.DX85lbQQ.js";import"../chunks/legacy.BJmkg3Y7.js";import{d as j}from"../chunks/downloader.controller.B-ZO0sSd.js";import{t as r}from"../chunks/telegram.service.BtJAcorA.js";import{p as ra}from"../chunks/stores.BCjcjC8m.js";function oa(l,t){let o=l.searchParams.get(t);if(o)return o;E(500,`The value for the parameter "${t}" was not provided.`)}const sa=async({url:l})=>{const t=oa(l,"albumUrl");return{albumUrl:t,streamed:{album:H.getAlbum(t)}}},Da=Object.freeze(Object.defineProperty({__proto__:null,load:sa},Symbol.toStringTag,{value:"Module"}));var la=d('<span class="artwork bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse aspect-square"></span> <span class="h-5 w-20 rounded-md self-center bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse my-3"></span> <span class="h-3 w-32 rounded-md self-center bg-[color:var(--tg-theme-secondary-bg-color)] animate-pulse"></span>',1);function ia(l){var t=la();J(4),u(l,t)}var na=(l,t,o,y)=>t({title:a(o).albumTitle,author:a(o).artistName,imageUrl:a(o).albumImage,year:"",recordType:"Album",youTubeMusicPlaylistUrl:y().url.searchParams.get("albumUrl")||""}),ca=d('<button>Add <span class="rounded-full bg-blue-500 text-white px-2 py-1">+</span></button>'),ma=d('<img class="artwork" alt="cover"> <div class="headings"><h3 class="title"> </h3> <p> </p></div> <!>',1),ua=(l,t,o)=>t(a(o).youTubeMusicPlaylistUrl),da=d('<img alt="check" class="h-5 w-5">'),ba=d('<li><button class="track"><p> </p></button> <!></li>'),pa=d('<ul class="track-list"></ul>'),fa=d('<div class="album-entry"><!> <!></div>');function Oa(l,t){W(t,!0);const o=$(),y=()=>aa(ra,"$page",o);let s=A(N([])),C=A(!1);function R(e){a(s).includes(e)?a(s).splice(a(s).indexOf(e),1):_(s,N(a(s).concat(e))),r.envokeHaptic("light")}async function w(e){a(s).length>0?await j.downloadSet(a(s)):e&&await j.download(e,1),r.closeWith("success")}F(()=>{a(s).length>0?(r.setMainButtonText(`Download Tracks (${a(s).length})`),r.onMainButtonClick(w)):(r.setMainButtonText("Download Album"),r.onMainButtonClick(()=>w(t.data.albumUrl)))});async function q(e){if(e.youTubeMusicPlaylistUrl.length===0)throw Error("No album URL");_(C,!0),await r.addToArrayItem("library",e),_(C,!1),_(M,!0)}let M=A(!1);Y(async()=>{r.showMainButton("Download Album"),r.onMainButtonClick(()=>w(t.data.albumUrl)),await r.findInArrayItem("library",y().url.searchParams.get("albumUrl")||"","youTubeMusicPlaylistUrl")&&_(M,!0)}),Z(()=>{r.offMainButtonClick(()=>w(t.data.albumUrl)),r.hideMainButton()});var T=fa(),I=m(T);O(I,()=>t.data.streamed.album,e=>{ia(e,{})},(e,b)=>{var p=ma(),k=K(p),n=h(k,2),c=m(n),f=m(c,!0);i(c);var g=h(c,2),x=m(g,!0);i(g),i(n);var U=h(n,2);S(U,()=>!a(M),P=>{var v=ca();v.__click=[na,q,b,y],u(P,v)}),D(()=>{L(k,"src",a(b).albumImage),B(f,a(b).albumTitle),B(x,a(b).artistName)}),u(e,p)});var z=h(I,2);O(z,()=>t.data.streamed.album,e=>{ta(e,{count:8,_class:"album-entry track-list mt-0"})},(e,b)=>{var p=pa();V(p,21,()=>a(b).result,X,(k,n)=>{var c=ba(),f=m(c);f.__click=[ua,R,n];var g=m(f),x=m(g,!0);i(g),i(f);var U=h(f,2);S(U,()=>a(s).includes(a(n).youTubeMusicPlaylistUrl),P=>{var v=da();L(v,"src",`${ea??""}/check-circle.svg`),u(P,v)}),i(c),D(()=>B(x,a(n).title)),u(k,c)}),i(p),u(e,p)}),i(T),u(l,T),G()}Q(["click"]);export{Oa as component,Da as universal};
